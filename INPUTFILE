####################################
#                                  #
#                                  #
#         CAST CONFIGFILE          #
#                                  #
#                                  #
#################################### 

# Verbosity 
# Amount of output information from CAST [0-5] (do not use verbosity > 4 :-)

verbosity              15

# Cores
# Number of OpenMP Threads (if compiled with openmp support)

cores                  4


####################################
#                                  #
#                                  #
#        I/O: FILES & TYPES        #
#                                  #
#                                  #
#################################### 

# Input file name

name                   cleth_opt.xyz

# Output file name

outname                CLETH_MD

# Input file type

inputtype              TINKER




#################################### 
#                                  #
#          PROGRAM TASK            #
#                                  #
####################################

# SP                   Single point energy calculation
# GRAD                 Single point energy calculation
# LOCOPT               Local optimization using Lib-LBFGS
# MD                   Molecular dynamics simulation
# SOLVADD              Solvation using Solvadd
# MC                   Monte Carlo
# MCM                  Monte Carlo with minimization
# CENTER               Center of mass/geometry
# TS                   Tabu Search (CAST: GOTS)
# WTINKER              Print Tinker structure (e.g. if started from PDB) (CAST: WRITE)
# RMSD                 Root mean square deviation
# DIMER2               Dimer method using cartesian space
# DIMER3               Dimer method using torsional space
# NEB                  Nudged elastic band calculation
# INTERACTION          Dividing the Molecule into two parts and calculate the interaction energy
# RDF                  Radial distribution of water around specified atom groups
# INTERNAL             Create Z-Matrix
# UMBRELLA             Umbrella Sampling
# PROFILE              Repeated Gradient Calculation of first input structure
# FEP                  Alchemical transformations using FEP
# ALIGN                Trajectory Alignment (Kabsch algorithm)
# PCAgen               Principal Component Analysis
# ENTROPY              Configurational and Conformational Entropy Calculations

task                   MD

####################################
#                                  #
#        Implicit Solvation        #
#                                  #
####################################

# solvmethod : VAC         (default) Vacuum
#              ONION       Numerical Still method
#              STILL       Analytical Still method
#              HCT         HCT method
#              OBC         OBC method
#              GRYCUK      Grycuk's method
#              ACE         ACE method
# surface    : TINKER      (default) TINKER's accessible surface area calculation
#              SASASTILL   Still's surface area calculation
#              GAUSS       SASA according to the global theorem of Gauss-Bonnet
#
# ONION should only be combined with GAUSS

solvmethod             VAC
surface                TINKER

#################################### 
#                                  #
#        PROFILE RUNS              #
#                                  #
####################################
#
# Number of repeated gradient calculations for PROFILE task

profileruns            10


####################################
#                                  #
#        ENERGY INTERFACES         #
#                                  #
####################################

# AMBER                AMBER force field
# (AMOEBA)               AMOEBA03 force field
# CHARMM22             CHARMM22 force field
# OPLSAA               OPLS all atoms force field
# (TERACHEM)             Terachem MPI Interface
# (TINKER)               Tinker syscall interface
# MOPAC                MOAPC2012 syscall Interface

interface              OPLSAA


# PARAMETER FILE FOR FF
# paramfile            amber.prm, amoeba.prm, oplsaa.prm, charmm22.prm

paramfile              oplsaa_mod.prm


# Keywords for MOPAC Call

MOPACkey               PM7




####################################
#                                  #
#          CUTOFF RADIUS           #
#                                  #
####################################

cutoff                 10000.0




####################################
#                                  #
#         libLBFGS OPTIONS         #
#                                  #
####################################

BFGSgrad               0.0001
BFGSmaxstep            10000


####################################
#                                  #
#        SIMULATION OPTIONS        #
#          (MC, TS, MD)            #
#                                  #
####################################

# Simulation Temperature 
# for TS and MC important for Metropolis Criterion
# overwritten for MD by MDheatramp

Temperature            298.15

# Save all (minimized) structures 
# which are within "Erange" kcal/mol from the final global minimum

Erange                 20.0

# Number of iterations in global optimization routine 
# or number of MD simulation steps
# overwritten for MD by MDsteps

Iterations             200

# Limit Fallback

Fallbacklimit          200

# use the current local minimum energy for metropolis criterion?

GOmetrolocal           0



####################################
#                                  #
#            MCM OPTIONS           #
#                                  #
####################################

# Step size in cartesian space 

MCstep_size            1.4

# Use minimization

MCminimization         1

# Use dihedral (1), cartesian (2) or biased dihedral (0) randomization

MCmovetype             1

# Maximum dihedral deviation

MCmax_dihedral         160.0




####################################
#                                  #
#            TS OPTIONS            #
#                                  #
###################################

# Do diversification before first TS steps?

TSmc_first             1

# How many TS steps need to fail in finding new minimum before diversification?

TSdivers_threshold      10

# How many diversification steps are applied?

TSdivers_iter          30




####################################
#                                  #
#       Periodic Boundaries        #
#                                  #
####################################

#Periodics            <Active 1(on)/0(off)> <box-x> <box-y> <box-z>

Periodics              0 40.0 40.0 40.0




####################################
#                                  #
#         STARTOPT OPTIONS         #
#                                  #
####################################

# startopt type
# 0                  Ringsearch
# 1                  Fold
# 2                  Solvadd [default]
# 3                  Ringsearch + Solvadd
# 4                  Fold + Solvadd

SOtype                 0

# startopt structure count
# number of structures generated by startopt routines

SOstructures           1




####################################
#                                  #
#           FOLD OPTIONS           #
#                                  #
####################################

# filename

FOLDfile               fold_sequence_file.txt

# Fold helices
#
# 0    Alpha [default]
# 1    3-10 Helix

FOLDhelix              0

# Fold sheets
#
# 0                   Beta-parallel [default]
# 1                   Beta-anti-parallel

FOLDsheet              0

# Fold turns
#
# 0                   beta-I [default]
# 1                   beta-I'
# 2                   beta-II
# 3                   beta-II'
# 4                   beta-VIa
# 5                   beta-VIb
# 6                   beta-VIII

FOLDturn               0




####################################
#                                  #
#        RINGSEARCH OPTIONS        #
#                                  #
####################################

# Number of different structures obtained via ringsearch

RSpool                 25

# Number of different structures for genetic population

RSpopulation           20

# Number of generations the evolution will propagated

RSgenerations          15

# Chance to close a selected ring

RSchance_close         0.75

# chance to apply mutation to an individual

RSchance_mutation      0.40

# decay of weight for an individual with respect to the energetic distance to the individual which is lowest in energy

#RSweight_decay        0.035

RSweight_decay         0.05

# Optimize structures with closed rings without strain afterwards

RSopt_final_closed     1




####################################
#                                  #
#          SOLVADD OPTIONS         #
#                                  #
####################################

# Hydrogen bond length parameter [default: 1.8]

SAhb                   1.8

# number of desired water molecules [default: 0(=no limit)]

SAlimit                1500

# water boundary type
#
# 0    layer [default]
# 1    sphere
# 2    box

SAboundary             0

# water boundary extent [default: 10.0] and push length (elongation of radius if limit is not reached)

SAradius               25.0

# force field parameter types of oxygen and hydrogen
#
# 53 54   OPLS-AA
# 101 88   CHARMM
# 2001 2002  AMBER

SAtypes                53 54

# Intermediate optimizations
#
# 0    none
# 1    each "shell"
# 2    all waters
# 3    1+2

SAopt                  0

# fix initial structure

SAfixinit              1




####################################
#                                  #
#            MD OPTIONS            #
#                                  #
####################################

# Number of Steps

MDsteps                10000
 
# Integrator
#
# 0                    Velocity-Verlet
# 1                    Beeman

MDintegrator           0

# Velocity Scaling

MDveloscale            1

# Thermostat (Nose-Hoover)

MDthermostat           1

# Timestep in picoseconds

MDtimestep             0.001

# Activate Tracking (Log and Snapshots)

MDtrack                1

#
#   Snapshots
#

# Number
MDsnap                 1000
# Buffer size
MDsnap_buffer          100
# Optimize snapshots
MDsnap_opt             0

# Heating process control
#
# MDheat               <step> <temperature at that step>
# MDheat               2000   293.15

MDheat                 0    0.15
MDheat                 5000 273.15

#Pressure Control via Berendsen barostat
#
MDpress                0
MDpcompress            0.000046
MDpdelay               2.0
MDptarget              1.0
 
# Spehrical boundaries' options
# 
# MDspehrical          <Active 0/1> <Radius 1> <Radius 2> <Force 1> <Force 2> <Exp 1> <Exp 2>

#MDspherical            0 34.0 34.1 10.0 10.0 2.0 4.0

# H bond constraints
#
# 0                    No Constraints
# 1                    All Hydrogend Bonds
# 2                    Specific Hydrogen Bonds
 
MDrattle               0

# Rattle bond specification
#
# MDrattlebond         <H index>
 
#MDrattlebond           7 12

# Iteration offset for restart files

MDrestart_offset       5000

# Resume simulation from restart file?

MDresume               0




####################################
#                                  #
#            FEP OPTIONS           #
#                                  #
####################################

FEPlambda      1.0
FEPdlambda     0.05
FEPvdwcouple   1.0
FEPeleccouple  0.5
FEPvshift      0.1
FEPcshift      2.0
FEPequil       100
FEPsteps       500
FEPfreq        1000
FEPbackward    0

#FEPcoupling  <0> Inter subsystem interactions are scaled <1> inter subsystem interactions are not scaled

FEPcouple   0




####################################
#                                  #
#        INTERACTION OPTIONS       #
#                                  #
####################################

# The interaction of substructures that are not bound to each other can be calculated
# IAlimits <Start Index Substructure> <End Index Substructure>

#IAlimits               1 122




####################################
#                                  #
#            RDF OPTIONS           #
#                                  #
####################################

# Distribution width

RDFwidth               0.5




####################################
#                                  #
#            PATH OPTIONS          #
#                                  #
####################################
#
# File containing the desired path end

PRendfile              PATHREL_END.xyz

# Maximum Energy distance within the path

PRdeltae               0.5

# Maximum structure distance with the path

PRdeltax               0.5




####################################
#                                  #
#           DIMER OPTIONS          #
#                                  #
####################################
#
# Distance between dimer start end endpoint

DIMERdistance          0.001

# Translation type 
# 0                   simple translation along dimer direction using specified stepsize
# 1                   conjugate gradient translation

DIMERtrans             1

# Stepsize for dimer translation

DIMERstepsize          3.0

# Convergence criterion for the dimer rotation

DIMERrotconvergence    5.0

# Maximum number of rotation and translation iterations

DIMERmaxit             50 250



####################################
#                                  #
#         UMBRELLA SAMPLING        #
#                                  #
####################################


# Number of equilibration steps
USequil             1000

# Offset for taking snapshots
USsnap                 2

#Torsion restraint (old)
#UStorsion            1 5 7 9 0.05 0.0


####################################
#                                  #
#        DIHEDRAL RESTRAINTS       #
#                                  #
####################################

# Quadratic Dihedral Bias Potential
#DIHBIAS                <atom 1> <atom 2> <atom 3> <atom 4> <angle> <force> <fix atom 1>

#DIHBIAS                 1 5 7 9 180.0 0.05 0
#DIHBIAS                2 5 6 9 150.0 5.0  0
#DIHBIAS                1 2 5 6 150.0 5.0  0
#DIHBIAS                1 2 5 6 95.0  10.0 0


####################################
#                                  #
#        DISTANCEL RESTRAINTS      #
#                                  #
####################################

#DISTBIAS         <atom 1> <atom 2> <ideal distance> <force> 

#DISTBIAS              1 9 3.0 3.0v



####################################
#                                  #
#       INTERNAL INDEXATION        #
#                                  #
####################################

#intdex                7
#intdex                9
#intdex                10
#intdex                11 


####################################
#                                  #
#          ATOM FIXATIONS          #
#                                  #
####################################

# Exclude nonbondeds between two fixed atoms in internal force fields

FIXexclude             0

# Remove rotations of hydrogens from main torsional angles

REMOVEHROT             0

# Fix a range of atoms 
#FIXrange               <start index> <end index>

#FIXrange               1 411

# Fixation of single atoms
#ATOMFIX                <INDEX> 

#ATOMFIX                1
#ATOMFIX                3
####################################
#                                  #
#   TRAJECTORY ALIGNMENT OPTIONS   #
#                                  #
####################################

# Should alignment be performed?
traj_align_bool                true
# Should distance meassures be calculated and printed?
traj_print_bool                false

# Reference frame for alignment (using Kabsch algorithm)
# default is "0"
ref_frame_num                   110


# Desired distance masurement unit for output
# 0: RMSD (default)
# 1: dRMSD
# 2: Hold and Sander Distance

dist_unit                       0

# if Holm and Sander Distance is chosen, pick value for r_c
# (contact cutoff distance)
# default is "20", as in original publication

holm_sand_r0                    5
####################################
#                                  #
#       ENTROPY-CALC OPTIONS   	   #
#                                  #
####################################

# Should alignment (Kabsch algorithm, minimizes RMSD) be performed
# prior to calculations? (options: false / true; true is default)
# entropy_ref_frame_num gives reference frame for alignment (default is 0)
entropy_alignment                 true
entropy_ref_frame_num             0

# Specify first frame to be used in entropy calculations
# default is 0
entropy_start_frame_num           0
# Specify offset value (only every n'th frame will be used in calculations)
entropy_offset                    1

# Temperature needed for Entropy etc. calculations in K
entropy_temp                      300.00

# Should the removal of degrees of freedom for rotation / translation be attempted?
entropy_remove_dof                true

# Use internal coordinates instead of cartesian coordinates?
# Use the CAST task to display the internal z-mat and then enter desired atom-indexes of bondlengths (bnd), angles (ang) and dihedral angles (dih).
# "none" also possible
entropy_use_internal              false
entropy_internal_bnd              none
entropy_internal_ang              none
entropy_internal_dih              4-23

# Should only specific atoms be used for entropy calculations?
# (only use with cartesian coordinates)
entropy_trunc_atoms_bool          false
entropy_trunc_atoms_num           3,4    

# Specify method used in entropy-calculations:
# 1 : Quasi-Harmonic-Approx., configurational entropy, according to Karplus et. al. (DOI 10.1021/ma50003a019)
# 2 : Quasi-Harmonic-Approx., conformational entropy, according to Knapp et. al. without corrections (Genome Inform. 2007;18:192-205.)
# 3 : Quasi-Harmonic-Approx., conformational entropy, according to Knapp et. al. with corrections (Genome Inform. 2007;18:192-205.)
# 4 : Nearest-Neighbor Nonparametric Method, configurational entropy, according to Hnizdo et. al. (DOI: 10.1002/jcc.20589)
# 5 : Nearest-Neighbor Nonparametric Method - Sum of Marginal Entropies, configurational entropy, according to Hnizdo et. al. (DOI: 10.1002/jcc.20589)
# 6 : Quasi-Harmonic-Approx., conformational entropy, according to Schlitter (use cartesians only)
# 0 : All of the above
entropy_method                    0
# if entropy_method = 3 || 4 || 5 : specify value for k in kNN-Algorithm (default is 4)
entropy_method_knn_k              4
####################################
#                                  #
#     	PCAgen OPTIONS             #
#                                  #
####################################

# Should alignment (Kabsch algorithm, minimizes RMSD) be performed
# prior to PCA-Analysis? (options: false / true; true is default)
# pca_ref_frame_num gives reference frame for alignment (default is 0)
pca_alignment                 true
pca_ref_frame_num             0

# Specify first frame to be used in PCA-Analysis
# default is 0
pca_start_frame_num           0

# Should the removal of degrees of freedom for rotation / translation be attempted?
pca_remove_dof                false

# Specify offset value (only every n'th frame will be used in calculations)
pca_offset                    1

# Should PCA-Mode-Coordinates and Eigenvectors be read from file?
# If true, we are expecting to read Eigenvectors and PCA-Modes from a previously CAST-generated file.
pca_read_vectors              false
pca_read_modes                false

# Use internal coordinates instead of cartesian coordinates? If yes, should they converted to metric coordinate space?
# Use the CAST task to display the internal z-mat and then enter desired atom-indexes of bondlengths (bnd), angles (ang) and dihedral angles (dih).
# "none" also possible
pca_use_internal              false
pca_internal_bnd              none
pca_internal_ang              none
pca_internal_dih              1

# Should only specific atoms be used for PCA-Analysis?
pca_trunc_atoms_bool          false
pca_trunc_atoms_num           2900-3000

# Optional variance cutoff. PCA Modes are truncated to enough dimensions so that the desired variance is achieved.
#pca_trunc_var                  20
# Optional truncation. Number of highest PCA modes to be in the output. ( 0: no truncation, all dimensions are printed).
#pca_trunc_dim                  2

# Print probability density of generated PCA modes?
pca_print_probability_density  true
# If true, specify the number of bins or a bin-width for histogramming the data
pca_histogram_width              0
pca_histogram_number_of_bins     10
pca_dimensions_for_histogramming 1,2

