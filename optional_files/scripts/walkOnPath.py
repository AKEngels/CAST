### script that takes a PES or a Free Energy Surface and walks on a given path

# USER INPUT
FILENAME = "freeEnergy.csv"  # name of the csv file
PATH = [[-180, -180], [-180, -175], [-175, -175], [-175, -170], [-170, -170],
        [-170, -165], [-165, -165], [-165, -160], [-160, -160], [-160, -155],
        [-155, -155], [-155, -150], [-150, -150], [-150, -145], [-150, -140],
        [-150, -135], [-150, -130], [-150, -125], [-150, -120], [-150, -115],
        [-150, -110], [-150, -105], [-150, -100], [-150, -95], [-150, -90],
        [-150, -85], [-150, -80], [-150, -75], [-150, -70], [-150, -65],
        [-150, -60], [-150, -55], [-150, -50], [-145, -50], [-140, -50],
        [-135, -50], [-130, -50], [-125, -50], [-120, -50], [-115, -50],
        [-110, -50], [-105, -50], [-100, -50], [-95, -50], [-90, -50], [-85, -50],
        [-80, -50], [-75, -50], [-70, -50], [-65, -50], [-60, -50], [-55, -50],
        [-50, -50], [-50, -45], [-45, -45], [-45, -40], [-40, -40], [-40, -35],
        [-35, -35], [-35, -30], [-35, -25], [-35, -20], [-35, -15], [-35, -10],
        [-35, -5], [-35, 0], [-35, 5], [-35, 10], [-35, 15], [-35, 20], [-35, 25],
        [-35, 30], [-35, 35], [-35, 40], [-35, 45], [-35, 50], [-35, 55], [-35, 60],
        [-35, 65], [-35, 70], [-35, 75], [-35, 80], [-35, 85], [-35, 90], [-35, 95],
        [-35, 100], [-35, 105], [-35, 110], [-35, 115], [-35, 120], [-35, 125],
        [-35, 130], [-35, 135], [-35, 140], [-35, 145], [-35, 150], [-35, 155],
        [-35, 160], [-35, 165], [-35, 170], [-35, 175], [-35, 180], [-30, 180],
        [-25, 180], [-20, 180], [-15, 180], [-10, 180], [-5, 180], [0, 180], [5, 180],
        [10, 180], [15, 180], [20, 180], [25, 180], [30, 180], [35, 180], [40, 180],
        [45, 180], [50, 180], [55, 180], [60, 180], [65, 180], [70, 180], [75, 180],
        [80, 180], [85, 180], [90, 180], [95, 180], [100, 180], [105, 180], [110, 180],
        [115, 180], [120, 180], [125, 180], [130, 180], [135, 180], [140, 180],
        [145, 180], [150, 180], [155, 180], [160, 180], [165, 180], [170, 180],
        [175, 180], [180, 180]]

################################################################################
import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt

# read csv file
with open(FILENAME) as pesfile:
    lines = pesfile.readlines()

# save content of csv file in matrix 'pes'
pes = []
for l in lines:
    linelist = l.split(",")
    for i,c in enumerate(linelist):
        if c.find("\n") != -1:
            c = c.replace("\n","")
            linelist[i] = c
    pes.append(linelist)

# get labels
x_labels = pes[0][1:len(pes[0])-1]  # first line
for i,x in enumerate(x_labels):
    x_labels[i] = int(x)
y_labels = []                       # first column
for i, line in enumerate(pes):
    if i != 0 and i != len(pes)-1:
        y_labels.append(int(line[0]))

# walk path
energies = []
with open("path.csv","w") as path:
    path.write("step,x,y,value\n")  # write headline
    for i,p in enumerate(PATH):
        x = x_labels.index(p[0])+1
        y = y_labels.index(p[1])+1
        value = float(pes[y][x])
        energies.append(value)
        path.write("{},{},{},{}\n".format(i+1, p[0], p[1], value))

# plot path
plt.plot(energies)
plt.xlabel("Step")
plt.ylabel("Energy [kcal/mol]")
plt.savefig("path.png")
plt.close()
